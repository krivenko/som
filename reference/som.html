

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>som: Main Python module of SOM &mdash; SOM  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3b04a184" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="som.spectral_stats: Statistical analysis of noisy spectral functions" href="spectral_stats.html" />
    <link rel="prev" title="Python API reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            SOM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#docker">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-som-from-source">Compiling SOM from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-som-from-source-using-easybuild">Compiling SOM from source using EasyBuild</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic.html">Basic description of the method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic.html#integral-equation-of-the-analytic-continuation-problem">Integral equation of the analytic continuation problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic.html#goodness-of-fit-functionals">Goodness of fit functionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic.html#minimization-of-the-chi-2-functionals">Minimization of the <span class="math notranslate nohighlight">\(\chi^2\)</span>-functionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic.html#post-processing-of-spectral-functions">Post-processing of spectral functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/observables.html">Supported observables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/observables.html#thermal-green-s-function-of-fermions">Thermal Green’s function of fermions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/observables.html#thermal-green-s-function-of-bosons-dynamical-susceptibilities-and-conductivity">Thermal Green’s function of bosons, dynamical susceptibilities and conductivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/observables.html#dynamical-response-functions-at-zero-temperature">Dynamical response functions at zero temperature</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/recovery.html">Recovery of observables on a real-frequency mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/spectral_stats.html">Statistical analysis of ensembles of spectral functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/socc.html">Stochastic Optimization with Consistent Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/socc.html#consistent-constraints-updates">Consistent-constraints updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/socc.html#construction-of-final-solution-using-the-consistent-constraints-protocol">Construction of final solution using the consistent-constraints protocol</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Usage examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/fermiongf/example.html">Fermionic Green’s function or self-energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/fermiongfsymm/example.html">Fermionic Green’s function or self-energy with enforced particle-hole symmetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bosoncorr/example.html">Green’s function of bosons and transverse magnetic susceptibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bosonautocorr/example.html">Charge susceptibility, longitudinal magnetic susceptibility and optical conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/zerotemp/example.html">Dynamical response function at zero temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/meshes/example.html">Input data defined on various meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/cov_matrix/example.html">Full covariance matrix of input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/spectral_stats/example.html">Statistical analysis of ensembles of spectral functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/socc/example.html">Stochastic Optimization with Consistent Constraints</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Python API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">som</span></code>: Main Python module of SOM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#som-som"><code class="docutils literal notranslate"><span class="pre">som.Som</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#som.Som"><code class="docutils literal notranslate"><span class="pre">Som</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.__init__"><code class="docutils literal notranslate"><span class="pre">Som.__init__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.accumulate"><code class="docutils literal notranslate"><span class="pre">Som.accumulate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.last_accumulate_parameters"><code class="docutils literal notranslate"><span class="pre">Som.last_accumulate_parameters</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.accumulate_status"><code class="docutils literal notranslate"><span class="pre">Som.accumulate_status</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.adjust_f"><code class="docutils literal notranslate"><span class="pre">Som.adjust_f()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.compute_final_solution"><code class="docutils literal notranslate"><span class="pre">Som.compute_final_solution()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.compute_final_solution_cc"><code class="docutils literal notranslate"><span class="pre">Som.compute_final_solution_cc()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.run"><code class="docutils literal notranslate"><span class="pre">Som.run()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.clear"><code class="docutils literal notranslate"><span class="pre">Som.clear()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.observable_kind"><code class="docutils literal notranslate"><span class="pre">Som.observable_kind</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.dim"><code class="docutils literal notranslate"><span class="pre">Som.dim</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.particular_solutions"><code class="docutils literal notranslate"><span class="pre">Som.particular_solutions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.objf_min"><code class="docutils literal notranslate"><span class="pre">Som.objf_min</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.solution"><code class="docutils literal notranslate"><span class="pre">Som.solution()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.solutions"><code class="docutils literal notranslate"><span class="pre">Som.solutions</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.objf"><code class="docutils literal notranslate"><span class="pre">Som.objf()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.objf_list"><code class="docutils literal notranslate"><span class="pre">Som.objf_list</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.histogram"><code class="docutils literal notranslate"><span class="pre">Som.histogram()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Som.histograms"><code class="docutils literal notranslate"><span class="pre">Som.histograms</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#free-functions">Free functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#som.fill_refreq"><code class="docutils literal notranslate"><span class="pre">fill_refreq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#som.compute_tail"><code class="docutils literal notranslate"><span class="pre">compute_tail()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#som.reconstruct"><code class="docutils literal notranslate"><span class="pre">reconstruct()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#som.estimate_boson_corr_spectrum_norms"><code class="docutils literal notranslate"><span class="pre">estimate_boson_corr_spectrum_norms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#som.count_good_solutions"><code class="docutils literal notranslate"><span class="pre">count_good_solutions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#auxiliary-types">Auxiliary types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#som.Rectangle"><code class="docutils literal notranslate"><span class="pre">Rectangle</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#som.Rectangle.center"><code class="docutils literal notranslate"><span class="pre">Rectangle.center</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Rectangle.width"><code class="docutils literal notranslate"><span class="pre">Rectangle.width</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Rectangle.height"><code class="docutils literal notranslate"><span class="pre">Rectangle.height</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Rectangle.norm"><code class="docutils literal notranslate"><span class="pre">Rectangle.norm</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Rectangle.__call__"><code class="docutils literal notranslate"><span class="pre">Rectangle.__call__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#som.Configuration"><code class="docutils literal notranslate"><span class="pre">Configuration</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#som.Configuration.__len__"><code class="docutils literal notranslate"><span class="pre">Configuration.__len__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Configuration.__getitem__"><code class="docutils literal notranslate"><span class="pre">Configuration.__getitem__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Configuration.__iter__"><code class="docutils literal notranslate"><span class="pre">Configuration.__iter__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#som.Configuration.__call__"><code class="docutils literal notranslate"><span class="pre">Configuration.__call__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spectral_stats.html"><code class="docutils literal notranslate"><span class="pre">som.spectral_stats</span></code>: Statistical analysis of noisy spectral functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spectral_stats.html#som.spectral_stats.spectral_integral"><code class="docutils literal notranslate"><span class="pre">spectral_integral()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spectral_stats.html#som.spectral_stats.spectral_avg"><code class="docutils literal notranslate"><span class="pre">spectral_avg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spectral_stats.html#som.spectral_stats.spectral_disp"><code class="docutils literal notranslate"><span class="pre">spectral_disp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spectral_stats.html#som.spectral_stats.spectral_corr"><code class="docutils literal notranslate"><span class="pre">spectral_corr()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../script_porting.html">SOM 1.x script porting guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../script_porting.html#python-modules">Python modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../script_porting.html#construction-of-the-som-object">Construction of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Som</span></code> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../script_porting.html#deprecation-of-som-run">Deprecation of <code class="xref py py-func docutils literal notranslate"><span class="pre">Som.run()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../script_porting.html#post-processing-of-spectral-functions">Post-processing of spectral functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../script_porting.html#direct-access-to-spectral-functions">Direct access to spectral functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About SOM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#triqs">TRIQS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#usage-disclaimer">Usage disclaimer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id2">2.1.1 (2025-06-30)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id3">2.1.0 (2023-10-03)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id4">2.0.0 (2022-06-27)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#major-changes-and-new-features">Major changes and new features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#python-api-changes">Python API changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#build-system-and-developer-tools">Build system and developer tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id5">1.2 (2020-03-15)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id6">1.1 (2017-04-23)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id7">1.0 (2017-03-19)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../search.html">Search Page</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SOM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Python API reference</a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">som</span></code>: Main Python module of SOM</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/som.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="som-main-python-module-of-som">
<span id="som-ref"></span><h1><code class="docutils literal notranslate"><span class="pre">som</span></code>: Main Python module of SOM<a class="headerlink" href="#som-main-python-module-of-som" title="Link to this heading"></a></h1>
<section id="som-som">
<h2><code class="docutils literal notranslate"><span class="pre">som.Som</span></code><a class="headerlink" href="#som-som" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="som.Som">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">Som</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><span class="pre">Gf</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><span class="pre">Gf</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'FermionGf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtering_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/som/som.html#Som"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#som.Som" title="Link to this definition"></a></dt>
<dd><p>Implementation of the Stochastic Optimization Method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="som.Som.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><span class="pre">Gf</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><span class="pre">Gf</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'FermionGf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtering_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/som/som.html#Som.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#som.Som.__init__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhs</strong> (<a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.gf.Gf</span></code></a>) – Right hand side of the <a class="reference internal" href="../guide/basic.html#integral-equation"><span class="std std-ref">integral equation</span></a> to be solved, defined on
<a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.meshes.MeshImTime.html#triqs.gf.meshes.MeshImTime" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.meshes.MeshImTime</span></code></a>,
<a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.meshes.MeshImFreq.html#triqs.gf.meshes.MeshImFreq" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.meshes.MeshImFreq</span></code></a> or
<a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.meshes.MeshLegendre.html#triqs.gf.meshes.MeshLegendre" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.meshes.MeshLegendre</span></code></a>.
The target shape of <code class="docutils literal notranslate"><span class="pre">rhs</span></code> must be <span class="math notranslate nohighlight">\(M{\times}M\)</span>.
If <span class="math notranslate nohighlight">\(M&gt;1\)</span>, only its diagonal matrix elements will be
considered and used as input data for <span class="math notranslate nohighlight">\(M\)</span> independent
continuation problems.</p></li>
<li><p><strong>errors</strong> – Either <a class="reference internal" href="../guide/basic.html#error-bars"><span class="std std-ref">error bars</span></a> <span class="math notranslate nohighlight">\(\sigma_n\)</span>
(GF container of the same type and target shape as
<code class="docutils literal notranslate"><span class="pre">rhs</span></code>) or a packed list of <a class="reference internal" href="../guide/basic.html#cov-matrix"><span class="std std-ref">covariance matrices</span></a> (<code class="docutils literal notranslate"><span class="pre">Gf(mesh=MeshProduct(rhs.mesh,</span> <span class="pre">rhs.mesh),</span>
<span class="pre">target_shape=[M])</span></code> with each target element
corresponding to one covariance matrix).</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Selection of the <a class="reference internal" href="../guide/observables.html#observables"><span class="std std-ref">observable kind</span></a>
(and its respective integral kernel) to be used. One of
<code class="docutils literal notranslate"><span class="pre">FermionGf</span></code>, <code class="docutils literal notranslate"><span class="pre">FermionGfSymm</span></code>, <code class="docutils literal notranslate"><span class="pre">BosonCorr</span></code>,
<code class="docutils literal notranslate"><span class="pre">BosonAutoCorr</span></code>, <code class="docutils literal notranslate"><span class="pre">ZeroTemp</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">FermionGf</span></code>.</p></li>
<li><p><strong>norms</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]) – <p>Requested <a class="reference internal" href="../guide/basic.html#solution-norm"><span class="std std-ref">solution norms</span></a> either as
a list of <span class="math notranslate nohighlight">\(M\)</span> real numbers or as a single real
number for all <span class="math notranslate nohighlight">\(M\)</span> continuation problems. For
observable kinds <code class="docutils literal notranslate"><span class="pre">FermionGf</span></code>, <code class="docutils literal notranslate"><span class="pre">FermionGfSymm</span></code> and
<code class="docutils literal notranslate"><span class="pre">ZeroTemp</span></code> this parameter is optional and defaults to
1.0. For <code class="docutils literal notranslate"><span class="pre">BosonCorr</span></code> and <code class="docutils literal notranslate"><span class="pre">BosonAutoCorr</span></code> it must be
provided by the user.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>When unknown a priori in the latter case, the norms can
be approximately estimated from <code class="docutils literal notranslate"><span class="pre">rhs</span></code> using
<a class="reference internal" href="#som.estimate_boson_corr_spectrum_norms" title="som.estimate_boson_corr_spectrum_norms"><code class="xref py py-func docutils literal notranslate"><span class="pre">estimate_boson_corr_spectrum_norms()</span></code></a>.</p>
</div>
</p></li>
<li><p><strong>filtering_levels</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or
<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], optional) – <a class="reference internal" href="../guide/basic.html#cov-matrix-filtered"><span class="std std-ref">Filtering levels</span></a>
for covariance matrices either as
a list of <span class="math notranslate nohighlight">\(M\)</span> real numbers or as a
single real number for all <span class="math notranslate nohighlight">\(M\)</span>
continuation problems. Can only be specified
when the covariance matrices are used.
Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.accumulate">
<span class="sig-name descname"><span class="pre">accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.accumulate" title="Link to this definition"></a></dt>
<dd><p>Accumulate <a class="reference internal" href="../guide/basic.html#particular-solutions"><span class="std std-ref">particular solutions</span></a>.
This method can be called multiple times to accumulate the particular solutions incrementally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – See below.</p>
</dd>
</dl>
<p><strong>Main parameters</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>energy_window</p></td>
<td><p>(float,float)</p></td>
<td><p>–</p></td>
<td><p>Estimated lower and upper bounds of the spectrum.</p></td>
</tr>
<tr class="row-odd"><td><p>max_time</p></td>
<td><p>int</p></td>
<td><p>-1 = infinite</p></td>
<td><p>Maximum runtime in seconds, use -1 to set infinite.</p></td>
</tr>
<tr class="row-even"><td><p>verbosity</p></td>
<td><p>int</p></td>
<td><p>2 on MPI rank 0,
0 otherwise.</p></td>
<td><p>Verbosity level (max level - 3).</p></td>
</tr>
<tr class="row-odd"><td><p>t</p></td>
<td><p>int</p></td>
<td><p>50</p></td>
<td><p>Number of elementary updates per global update (<span class="math notranslate nohighlight">\(T\)</span>).
Bigger values make the algorithm more ergodic.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Enable <a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">Consistent Constraints updates</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>int</p></td>
<td><p>100</p></td>
<td><p>Number of global updates (<span class="math notranslate nohighlight">\(F\)</span>). Bigger values make the algorithm more ergodic.</p></td>
</tr>
<tr class="row-even"><td><p>l</p></td>
<td><p>int</p></td>
<td><p>2000</p></td>
<td><p>Number of particular solutions to accumulate (<span class="math notranslate nohighlight">\(L\)</span>); ignored if <code class="docutils literal notranslate"><span class="pre">adjust_l=True</span></code>.
Bigger values reduce noise in the final solution / make it smoother.</p></td>
</tr>
<tr class="row-odd"><td><p>adjust_l</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Automatically adjust the number of particular solutions to accumulate (<span class="math notranslate nohighlight">\(L\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p>make_histograms</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Accumulate histograms of <span class="math notranslate nohighlight">\(\chi\)</span>, where <span class="math notranslate nohighlight">\(\chi^2\)</span> is the objective function.</p></td>
</tr>
</tbody>
</table>
<p><strong>Fine tuning options</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>random_seed</p></td>
<td><p>int</p></td>
<td><p>34788 +
928374 * MPI.rank</p></td>
<td><p>Seed for random number generator.</p></td>
</tr>
<tr class="row-odd"><td><p>random_name</p></td>
<td><p>str</p></td>
<td><p>“”</p></td>
<td><p>Name of random number generator (MT19937 by default).</p></td>
</tr>
<tr class="row-even"><td><p>max_rects</p></td>
<td><p>int</p></td>
<td><p>60</p></td>
<td><p>Maximum number of rectangles in a particular solution (<span class="math notranslate nohighlight">\(K_{max}\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p>min_rect_width</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p>Minimal width of a rectangle, in units of the energy window width.</p></td>
</tr>
<tr class="row-even"><td><p>min_rect_weight</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p>Minimal weight of a rectangle, in units of the requested solution norm.</p></td>
</tr>
<tr class="row-odd"><td><p>t1</p></td>
<td><p>int</p></td>
<td><p>-1</p></td>
<td><p>Number of elementary updates in the first stage of a global update.
When set to -1, the number of elementary updates will be chosen randomly for each global update
from the <span class="math notranslate nohighlight">\([1; T[\)</span> range.</p></td>
</tr>
<tr class="row-even"><td><p>distrib_d_max</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Maximal parameter of the power-law distribution function for the Metropolis algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p>gamma</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Proposal probability parameter <span class="math notranslate nohighlight">\(\gamma\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_cycle_length</p></td>
<td><p>int</p></td>
<td><p>10</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Number of proposed elementary updates between two successive CC
updates (only during the first stage of a global update).</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_max_iter</p></td>
<td><p>int</p></td>
<td><p>30</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Maximum allowed number of height adjustment iterations.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_rect_norm_variation_tol</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: The height adjustment procedure stops when variation of every
rectangle’s norm between two consecutive iterations is below this value. This parameter is
measured in units of the requested solution norm.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_height_penalty_max</p></td>
<td><p>float</p></td>
<td><p>1e3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Maximum value of the regularization parameters <span class="math notranslate nohighlight">\(Q_0(k)\)</span> that
penalize negative heights. Measured in units of (energy window width) / (solution norm).</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_height_penalty_divisor</p></td>
<td><p>float</p></td>
<td><p>10.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Divisor used to reduce the regularization parameters <span class="math notranslate nohighlight">\(Q_0(k)\)</span>
that penalize negative heights.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_der_penalty_init</p></td>
<td><p>float</p></td>
<td><p>1.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Initial value of the regularization parameters <span class="math notranslate nohighlight">\(Q_1(k)\)</span>
and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> that penalize large derivatives of a solution.
Measured in units of (energy window width)^2 / (solution norm) for <span class="math notranslate nohighlight">\(Q_1(k)\)</span> and
in units of (energy window width)^3 / (solution norm) for <span class="math notranslate nohighlight">\(Q_2(k)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_der_penalty_threshold</p></td>
<td><p>float</p></td>
<td><p>0.1</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Sets the threshold value of the products <span class="math notranslate nohighlight">\(|Q_1(k) A'(k)|\)</span> and
<span class="math notranslate nohighlight">\(|Q_2(k) A''(k)|\)</span>, above which derivative regularization parameters <span class="math notranslate nohighlight">\(Q_1(k)\)</span> and
<span class="math notranslate nohighlight">\(Q_2(k)\)</span> need to be reduced.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_der_penalty_increase_coeff</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Coefficient used to increase the regularization parameters
<span class="math notranslate nohighlight">\(Q_1(k)\)</span> and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> that penalize large derivatives of a solution.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_der_penalty_limiter</p></td>
<td><p>float</p></td>
<td><p>1e3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Coefficient that limits growth of the regularization parameters
<span class="math notranslate nohighlight">\(Q_1(k)\)</span> and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> penalizing large derivatives of a solution.</p></td>
</tr>
<tr class="row-odd"><td><p>adjust_l_range</p></td>
<td><p>(int,int)</p></td>
<td><p>(100,2000)</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Search range for the number of particular solutions to accumulate.</p></td>
</tr>
<tr class="row-even"><td><p>adjust_l_good_chi</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Maximal ratio <span class="math notranslate nohighlight">\(\chi/\chi_\mathrm{min}\)</span> for a particular
solution to be considered good.</p></td>
</tr>
<tr class="row-odd"><td><p>adjust_l_verygood_chi</p></td>
<td><p>float</p></td>
<td><p>4/3</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Maximal ratio <span class="math notranslate nohighlight">\(\chi/\chi_\mathrm{min}\)</span> for a particular
solution to be considered very good.</p></td>
</tr>
<tr class="row-even"><td><p>adjust_l_ratio</p></td>
<td><p>float</p></td>
<td><p>0.95</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Critical ratio <span class="math notranslate nohighlight">\(N_\mathrm{very good}/N_\mathrm{good}\)</span> to
stop the <span class="math notranslate nohighlight">\(L\)</span>-adjustment procedure.</p></td>
</tr>
<tr class="row-odd"><td><p>hist_max</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Right boundary of the histograms, in units of <span class="math notranslate nohighlight">\(\chi_\mathrm{min}\)</span>
(left boundary is always set to <span class="math notranslate nohighlight">\(\chi_\mathrm{min}\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p>hist_n_bins</p></td>
<td><p>int</p></td>
<td><p>100</p></td>
<td><p>Number of bins for the histograms.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.last_accumulate_parameters">
<span class="sig-name descname"><span class="pre">last_accumulate_parameters</span></span><a class="headerlink" href="#som.Som.last_accumulate_parameters" title="Link to this definition"></a></dt>
<dd><p>Set of parameters used in the last call to <a class="reference internal" href="#som.Som.accumulate" title="som.Som.accumulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">accumulate()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#dict" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.10/library/functions.html#object" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.accumulate_status">
<span class="sig-name descname"><span class="pre">accumulate_status</span></span><a class="headerlink" href="#som.Som.accumulate_status" title="Link to this definition"></a></dt>
<dd><p>Status code of <a class="reference internal" href="#som.Som.accumulate" title="som.Som.accumulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">accumulate()</span></code></a> on exit.</p>
<ul class="simple">
<li><p>0, if the accumulation has run until the end.</p></li>
<li><p>1, if it has run out of time.</p></li>
<li><p>2, if it has been stopped by receiving a signal.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.adjust_f">
<span class="sig-name descname"><span class="pre">adjust_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwrags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.adjust_f" title="Link to this definition"></a></dt>
<dd><p>Automatically adjust the number of global updates <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>This function scans a range of <span class="math notranslate nohighlight">\(F\)</span> (<code class="docutils literal notranslate"><span class="pre">f_range</span></code>), accumulates <code class="docutils literal notranslate"><span class="pre">l</span></code> <a class="reference internal" href="../guide/basic.html#particular-solutions"><span class="std std-ref">particular solutions</span></a>
for each <span class="math notranslate nohighlight">\(F\)</span> and evaluates the following functional for each solution,</p>
<div class="math notranslate nohighlight">
\[\kappa = \frac{1}{N-1}\sum_{n=2}^N
\frac{1}{2}\left[1 - \frac{\Re[\Delta(n)\Delta^*(n-1)]}{|\Delta(n)\Delta^*(n-1)|} \right],\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta(n)\)</span> are discrepancies</p>
<div class="math notranslate nohighlight">
\[\Delta(n) = \int_{\epsilon_\mathrm{min}}^{\epsilon_\mathrm{max}}
            K(n, \epsilon) A(\epsilon) d\epsilon - G(n).\]</div>
<p><span class="math notranslate nohighlight">\(\kappa\)</span> characterizes anti-correlation between adjacent discrepancies and can serve
as a measure of ergodicity in Markov chains. If <span class="math notranslate nohighlight">\(\kappa\)</span> exceeds the value of
parameter <code class="docutils literal notranslate"><span class="pre">kappa</span></code> for at least a half of accumulated solutions, <span class="math notranslate nohighlight">\(F\)</span> is considered sufficient.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0: </span>The automatic adjustment algorithm does not support continuation problems with full covariance matrices.
If the <a class="reference internal" href="#som.Som" title="som.Som"><code class="xref py py-class docutils literal notranslate"><span class="pre">Som</span></code></a> object has been constructed using a covariance matrix, <a class="reference internal" href="#som.Som.adjust_f" title="som.Som.adjust_f"><code class="xref py py-func docutils literal notranslate"><span class="pre">adjust_f()</span></code></a> will raise a
<a class="reference external" href="https://docs.python.org/3.10/library/exceptions.html#RuntimeError" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – See below.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Selected value of <span class="math notranslate nohighlight">\(F\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
<p><strong>Main parameters</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>energy_window</p></td>
<td><p>(float,float)</p></td>
<td><p>–</p></td>
<td><p>Estimated lower and upper bounds of the spectrum.</p></td>
</tr>
<tr class="row-odd"><td><p>max_time</p></td>
<td><p>int</p></td>
<td><p>-1 = infinite</p></td>
<td><p>Maximum runtime in seconds, use -1 to set infinite.</p></td>
</tr>
<tr class="row-even"><td><p>verbosity</p></td>
<td><p>int</p></td>
<td><p>2 on MPI rank 0,
0 otherwise.</p></td>
<td><p>Verbosity level (max level - 3).</p></td>
</tr>
<tr class="row-odd"><td><p>t</p></td>
<td><p>int</p></td>
<td><p>50</p></td>
<td><p>Number of elementary updates per global update (<span class="math notranslate nohighlight">\(T\)</span>).
Bigger values make the algorithm more ergodic.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Enable <a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">Consistent Constraints updates</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>f_range</p></td>
<td><p>(int,int)</p></td>
<td><p>(100,5000)</p></td>
<td><p>Search range for the number of global updates.</p></td>
</tr>
</tbody>
</table>
<p><strong>Fine tuning options</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>random_seed</p></td>
<td><p>int</p></td>
<td><p>34788 +
928374 * MPI.rank</p></td>
<td><p>Seed for random number generator.</p></td>
</tr>
<tr class="row-odd"><td><p>random_name</p></td>
<td><p>str</p></td>
<td><p>“”</p></td>
<td><p>Name of random number generator (MT19937 by default).</p></td>
</tr>
<tr class="row-even"><td><p>max_rects</p></td>
<td><p>int</p></td>
<td><p>60</p></td>
<td><p>Maximum number of rectangles in a particular solution (<span class="math notranslate nohighlight">\(K_{max}\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p>min_rect_width</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p>Minimal width of a rectangle, in units of the energy window width.</p></td>
</tr>
<tr class="row-even"><td><p>min_rect_weight</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p>Minimal weight of a rectangle, in units of the requested solution norm.</p></td>
</tr>
<tr class="row-odd"><td><p>t1</p></td>
<td><p>int</p></td>
<td><p>-1</p></td>
<td><p>Number of elementary updates in the first stage of a global update.
When set to -1, the number of elementary updates will be chosen randomly for each global update
from the <span class="math notranslate nohighlight">\([1; T[\)</span> range.</p></td>
</tr>
<tr class="row-even"><td><p>distrib_d_max</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Maximal parameter of the power-law distribution function for the Metropolis algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p>gamma</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Proposal probability parameter <span class="math notranslate nohighlight">\(\gamma\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_cycle_length</p></td>
<td><p>int</p></td>
<td><p>10</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Number of proposed elementary updates between two successive CC
updates (only during the first stage of a global update).</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_max_iter</p></td>
<td><p>int</p></td>
<td><p>30</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Maximum allowed number of height adjustment iterations.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_rect_norm_variation_tol</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: The height adjustment procedure stops when variation of every
rectangle’s norm between two consecutive iterations is below this value. This parameter is
measured in units of the requested solution norm.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_height_penalty_max</p></td>
<td><p>float</p></td>
<td><p>1e3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Maximum value of the regularization parameters <span class="math notranslate nohighlight">\(Q_0(k)\)</span> that
penalize negative heights. Measured in units of (energy window width) / (solution norm).</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_height_penalty_divisor</p></td>
<td><p>float</p></td>
<td><p>10.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Divisor used to reduce the regularization parameters <span class="math notranslate nohighlight">\(Q_0(k)\)</span>
that penalize negative heights.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_der_penalty_init</p></td>
<td><p>float</p></td>
<td><p>1.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Initial value of the regularization parameters <span class="math notranslate nohighlight">\(Q_1(k)\)</span>
and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> that penalize large derivatives of a solution.
Measured in units of (energy window width)^2 / (solution norm) for <span class="math notranslate nohighlight">\(Q_1(k)\)</span> and
in units of (energy window width)^3 / (solution norm) for <span class="math notranslate nohighlight">\(Q_2(k)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_der_penalty_threshold</p></td>
<td><p>float</p></td>
<td><p>0.1</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Sets the threshold value of the products <span class="math notranslate nohighlight">\(|Q_1(k) A'(k)|\)</span> and
<span class="math notranslate nohighlight">\(|Q_2(k) A''(k)|\)</span>, above which derivative regularization parameters <span class="math notranslate nohighlight">\(Q_1(k)\)</span> and
<span class="math notranslate nohighlight">\(Q_2(k)\)</span> need to be reduced.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_der_penalty_increase_coeff</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Coefficient used to increase the regularization parameters
<span class="math notranslate nohighlight">\(Q_1(k)\)</span> and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> that penalize large derivatives of a solution.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_der_penalty_limiter</p></td>
<td><p>float</p></td>
<td><p>1e3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Coefficient that limits growth of the regularization parameters
<span class="math notranslate nohighlight">\(Q_1(k)\)</span> and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> penalizing large derivatives of a solution.</p></td>
</tr>
<tr class="row-odd"><td><p>l</p></td>
<td><p>int</p></td>
<td><p>20</p></td>
<td><p>Number of particular solutions used to adjust <span class="math notranslate nohighlight">\(F\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>kappa</p></td>
<td><p>float</p></td>
<td><p>0.25</p></td>
<td><p>Limiting value of <span class="math notranslate nohighlight">\(\kappa\)</span> used to adjust <span class="math notranslate nohighlight">\(F\)</span>.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.compute_final_solution">
<span class="sig-name descname"><span class="pre">compute_final_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">good_chi_rel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">good_chi_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">cmath.inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.compute_final_solution" title="Link to this definition"></a></dt>
<dd><p>Signature : (float good_chi_rel =  2.0, float good_chi_abs =  HUGE_VAL, int verbosity =  0) -&gt; list[float]</p>
<p>Select particular solutions according to the standard SOM criterion and compute the final solution.</p>
<p>Selected solutions must satisfy <span class="math notranslate nohighlight">\(\chi[A_j] \leq \chi_c^\mathrm{abs}\)</span> and <span class="math notranslate nohighlight">\(\chi[A_j] \leq \min_{j'}(\chi[A_{j'}]) \chi_c^\mathrm{rel}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>good_chi_rel</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Solution selection parameter <span class="math notranslate nohighlight">\(\chi_c^\mathrm{rel}\)</span>.</p></li>
<li><p><strong>good_chi_abs</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Solution selection parameter <span class="math notranslate nohighlight">\(\chi_c^\mathrm{abs}\)</span>.</p></li>
<li><p><strong>verbosity</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – When positive, print extra information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A length-<span class="math notranslate nohighlight">\(M\)</span> list of values of <span class="math notranslate nohighlight">\(\chi^2\)</span>, one element per continuation problem.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.compute_final_solution_cc">
<span class="sig-name descname"><span class="pre">compute_final_solution_cc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.compute_final_solution_cc" title="Link to this definition"></a></dt>
<dd><p>Select particular solutions and compute the final solution using the <a class="reference internal" href="../guide/socc.html#final-solution-cc"><span class="std std-ref">SOCC protocol</span></a>.</p>
<p>Selected solutions must satisfy <span class="math notranslate nohighlight">\(\chi[A_j] \leq \chi_c^\mathrm{abs}\)</span> and <span class="math notranslate nohighlight">\(\chi[A_j] \leq \min_{j'}(\chi[A_{j'}]) \chi_c^\mathrm{rel}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – See below.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A length-<span class="math notranslate nohighlight">\(M\)</span> list of values of <span class="math notranslate nohighlight">\(\chi^2\)</span>, one element per continuation problem.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
</dl>
<p><strong>Main parameters</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>refreq_mesh</p></td>
<td><p>MeshReFreq or
real 1D
array_like</p></td>
<td><p>–</p></td>
<td><p>Grid of energy points <span class="math notranslate nohighlight">\(\epsilon_k\)</span> used in CC regularization procedure.
Either a TRIQS real-frequency mesh object or a strictly ordered list of points.</p></td>
</tr>
<tr class="row-odd"><td><p>verbosity</p></td>
<td><p>int</p></td>
<td><p>1 on MPI rank 0,
0 otherwise.</p></td>
<td><p>Verbosity level (max level - 2).</p></td>
</tr>
<tr class="row-even"><td><p>good_chi_rel</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Maximal ratio <span class="math notranslate nohighlight">\(\chi/\chi_\mathrm{min}\)</span> for a particular solution to be selected.
This criterion must be fulfilled together with the one set by <code class="docutils literal notranslate"><span class="pre">good_chi_abs</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>good_chi_abs</p></td>
<td><p>float</p></td>
<td><p>infinity</p></td>
<td><p>Maximal value of <span class="math notranslate nohighlight">\(\chi\)</span> for a particular solution to be selected.
This criterion must be fulfilled together with the one set by <code class="docutils literal notranslate"><span class="pre">good_chi_rel</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>default_model</p></td>
<td><p>Real 1D array</p></td>
<td><p>[]</p></td>
<td><p>Optional default model of the spectral function evaluated at energy points of <code class="docutils literal notranslate"><span class="pre">refreq_mesh</span></code>
(<span class="math notranslate nohighlight">\(A_T(\epsilon_k)\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p>default_model_weights</p></td>
<td><p>Real 1D array</p></td>
<td><p>[]</p></td>
<td><p>Weights determining how much deviations from <code class="docutils literal notranslate"><span class="pre">default_model</span></code> are penalized at each energy point
(<span class="math notranslate nohighlight">\(T_k\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p>max_iter</p></td>
<td><p>int</p></td>
<td><p>50</p></td>
<td><p>Maximum allowed number of parameter adjustment iterations.</p></td>
</tr>
<tr class="row-odd"><td><p>max_sum_abs_c</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Stop parameter adjustment iterations when expansion coefficients <span class="math notranslate nohighlight">\(c_j\)</span> make the sum
<span class="math notranslate nohighlight">\(\sum_j |c_j|\)</span> exceed this value.</p></td>
</tr>
</tbody>
</table>
<p><strong>Fine tuning options</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ew_penalty_coeff</p></td>
<td><p>float</p></td>
<td><p>1.0</p></td>
<td><p>Coefficient of the term that penalizes large deviations from the equal-weight superposition.</p></td>
</tr>
<tr class="row-odd"><td><p>amp_penalty_max</p></td>
<td><p>float</p></td>
<td><p>1e3</p></td>
<td><p>Maximum value of the regularization parameters that penalize negative values of
the spectral function (<span class="math notranslate nohighlight">\(\mathcal{Q}_k\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p>amp_penalty_divisor</p></td>
<td><p>float</p></td>
<td><p>10.0</p></td>
<td><p>Divisor used to reduce the regularization parameters that penalize negative values of
the spectral function (<span class="math notranslate nohighlight">\(\mathcal{Q}_k\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p>der_penalty_init</p></td>
<td><p>float</p></td>
<td><p>0.1</p></td>
<td><p>Initial value of the regularization parameters that penalize large derivatives of the solution
(<span class="math notranslate nohighlight">\(\mathcal{D}\)</span>). Before this parameter is used, it is divided by the number of selected
particular solutions.</p></td>
</tr>
<tr class="row-even"><td><p>der_penalty_coeff</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Coefficient used to increase the regularization parameters that penalize large derivatives of
the solution (<span class="math notranslate nohighlight">\(f\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p>monitor</p></td>
<td><p>function</p></td>
<td><p>None</p></td>
<td><p>Monitor function called at each parameter adjustment iteration. It takes 4 arguments,</p>
<ul class="simple">
<li><p>Current list of expansion coefficients <span class="math notranslate nohighlight">\(c_j\)</span>;</p></li>
<li><p>Amplitudes of the spectrum and respective regularization parameters as a
<span class="math notranslate nohighlight">\((A_k, Q_k)\)</span> pair;</p></li>
<li><p>Derivatives of the spectrum and respective regularization parameters as a
<span class="math notranslate nohighlight">\((A'_k, D_k)\)</span> pair;</p></li>
<li><p>Second derivatives of the spectrum and respective regularization parameters as a
<span class="math notranslate nohighlight">\((A''_k, B_k)\)</span> pair.</p></li>
</ul>
<p>Returning <code class="docutils literal notranslate"><span class="pre">True</span></code> from the function stops the adjustment procedure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.run" title="Link to this definition"></a></dt>
<dd><p>Accumulate particular solutions and compute the final solution using the standard SOM criterion.</p>
<p>Calling this method is equivalent to calling <a class="reference internal" href="#som.Som.accumulate" title="som.Som.accumulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">accumulate()</span></code></a> and <a class="reference internal" href="#som.Som.compute_final_solution" title="som.Som.compute_final_solution"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_final_solution()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">good_chi_rel=adjust_l_good_chi</span></code>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0: </span>Use <a class="reference internal" href="#som.Som.accumulate" title="som.Som.accumulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">accumulate()</span></code></a> and <a class="reference internal" href="#som.Som.compute_final_solution" title="som.Som.compute_final_solution"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_final_solution()</span></code></a> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – See below.</p>
</dd>
</dl>
<p><strong>Main parameters</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>energy_window</p></td>
<td><p>(float,float)</p></td>
<td><p>–</p></td>
<td><p>Estimated lower and upper bounds of the spectrum.</p></td>
</tr>
<tr class="row-odd"><td><p>max_time</p></td>
<td><p>int</p></td>
<td><p>-1 = infinite</p></td>
<td><p>Maximum runtime in seconds, use -1 to set infinite.</p></td>
</tr>
<tr class="row-even"><td><p>verbosity</p></td>
<td><p>int</p></td>
<td><p>2 on MPI rank 0,
0 otherwise.</p></td>
<td><p>Verbosity level (max level - 3).</p></td>
</tr>
<tr class="row-odd"><td><p>t</p></td>
<td><p>int</p></td>
<td><p>50</p></td>
<td><p>Number of elementary updates per global update (<span class="math notranslate nohighlight">\(T\)</span>).
Bigger values make the algorithm more ergodic.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Enable <a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">Consistent Constraints updates</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>int</p></td>
<td><p>100</p></td>
<td><p>Number of global updates (<span class="math notranslate nohighlight">\(F\)</span>). Bigger values make the algorithm more ergodic.</p></td>
</tr>
<tr class="row-even"><td><p>l</p></td>
<td><p>int</p></td>
<td><p>2000</p></td>
<td><p>Number of particular solutions to accumulate (<span class="math notranslate nohighlight">\(L\)</span>); ignored if <code class="docutils literal notranslate"><span class="pre">adjust_l=True</span></code>.
Bigger values reduce noise in the final solution / make it smoother.</p></td>
</tr>
<tr class="row-odd"><td><p>adjust_l</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Automatically adjust the number of particular solutions to accumulate (<span class="math notranslate nohighlight">\(L\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p>make_histograms</p></td>
<td><p>bool</p></td>
<td><p>False</p></td>
<td><p>Accumulate histograms of <span class="math notranslate nohighlight">\(\chi\)</span>, where <span class="math notranslate nohighlight">\(\chi^2\)</span> is the objective function.</p></td>
</tr>
</tbody>
</table>
<p><strong>Fine tuning options</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>random_seed</p></td>
<td><p>int</p></td>
<td><p>34788 +
928374 * MPI.rank</p></td>
<td><p>Seed for random number generator.</p></td>
</tr>
<tr class="row-odd"><td><p>random_name</p></td>
<td><p>str</p></td>
<td><p>“”</p></td>
<td><p>Name of random number generator (MT19937 by default).</p></td>
</tr>
<tr class="row-even"><td><p>max_rects</p></td>
<td><p>int</p></td>
<td><p>60</p></td>
<td><p>Maximum number of rectangles in a particular solution (<span class="math notranslate nohighlight">\(K_{max}\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p>min_rect_width</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p>Minimal width of a rectangle, in units of the energy window width.</p></td>
</tr>
<tr class="row-even"><td><p>min_rect_weight</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p>Minimal weight of a rectangle, in units of the requested solution norm.</p></td>
</tr>
<tr class="row-odd"><td><p>t1</p></td>
<td><p>int</p></td>
<td><p>-1</p></td>
<td><p>Number of elementary updates in the first stage of a global update.
When set to -1, the number of elementary updates will be chosen randomly for each global update
from the <span class="math notranslate nohighlight">\([1; T[\)</span> range.</p></td>
</tr>
<tr class="row-even"><td><p>distrib_d_max</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Maximal parameter of the power-law distribution function for the Metropolis algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p>gamma</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Proposal probability parameter <span class="math notranslate nohighlight">\(\gamma\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_cycle_length</p></td>
<td><p>int</p></td>
<td><p>10</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Number of proposed elementary updates between two successive CC
updates (only during the first stage of a global update).</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_max_iter</p></td>
<td><p>int</p></td>
<td><p>30</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Maximum allowed number of height adjustment iterations.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_rect_norm_variation_tol</p></td>
<td><p>float</p></td>
<td><p>1e-3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: The height adjustment procedure stops when variation of every
rectangle’s norm between two consecutive iterations is below this value. This parameter is
measured in units of the requested solution norm.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_height_penalty_max</p></td>
<td><p>float</p></td>
<td><p>1e3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Maximum value of the regularization parameters <span class="math notranslate nohighlight">\(Q_0(k)\)</span> that
penalize negative heights. Measured in units of (energy window width) / (solution norm).</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_height_penalty_divisor</p></td>
<td><p>float</p></td>
<td><p>10.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Divisor used to reduce the regularization parameters <span class="math notranslate nohighlight">\(Q_0(k)\)</span>
that penalize negative heights.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_der_penalty_init</p></td>
<td><p>float</p></td>
<td><p>1.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Initial value of the regularization parameters <span class="math notranslate nohighlight">\(Q_1(k)\)</span>
and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> that penalize large derivatives of a solution.
Measured in units of (energy window width)^2 / (solution norm) for <span class="math notranslate nohighlight">\(Q_1(k)\)</span> and
in units of (energy window width)^3 / (solution norm) for <span class="math notranslate nohighlight">\(Q_2(k)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_der_penalty_threshold</p></td>
<td><p>float</p></td>
<td><p>0.1</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Sets the threshold value of the products <span class="math notranslate nohighlight">\(|Q_1(k) A'(k)|\)</span> and
<span class="math notranslate nohighlight">\(|Q_2(k) A''(k)|\)</span>, above which derivative regularization parameters <span class="math notranslate nohighlight">\(Q_1(k)\)</span> and
<span class="math notranslate nohighlight">\(Q_2(k)\)</span> need to be reduced.</p></td>
</tr>
<tr class="row-odd"><td><p>cc_update_der_penalty_increase_coeff</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Coefficient used to increase the regularization parameters
<span class="math notranslate nohighlight">\(Q_1(k)\)</span> and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> that penalize large derivatives of a solution.</p></td>
</tr>
<tr class="row-even"><td><p>cc_update_der_penalty_limiter</p></td>
<td><p>float</p></td>
<td><p>1e3</p></td>
<td><p><a class="reference internal" href="../guide/socc.html#cc-update"><span class="std std-ref">CC update</span></a>: Coefficient that limits growth of the regularization parameters
<span class="math notranslate nohighlight">\(Q_1(k)\)</span> and <span class="math notranslate nohighlight">\(Q_2(k)\)</span> penalizing large derivatives of a solution.</p></td>
</tr>
<tr class="row-odd"><td><p>adjust_l_range</p></td>
<td><p>(int,int)</p></td>
<td><p>(100,2000)</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Search range for the number of particular solutions to accumulate.</p></td>
</tr>
<tr class="row-even"><td><p>adjust_l_good_chi</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Maximal ratio <span class="math notranslate nohighlight">\(\chi/\chi_\mathrm{min}\)</span> for a particular
solution to be considered good.</p></td>
</tr>
<tr class="row-odd"><td><p>adjust_l_verygood_chi</p></td>
<td><p>float</p></td>
<td><p>4/3</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Maximal ratio <span class="math notranslate nohighlight">\(\chi/\chi_\mathrm{min}\)</span> for a particular
solution to be considered very good.</p></td>
</tr>
<tr class="row-even"><td><p>adjust_l_ratio</p></td>
<td><p>float</p></td>
<td><p>0.95</p></td>
<td><p>Automatic <span class="math notranslate nohighlight">\(L\)</span> adjustment: Critical ratio <span class="math notranslate nohighlight">\(N_\mathrm{very good}/N_\mathrm{good}\)</span> to
stop the <span class="math notranslate nohighlight">\(L\)</span>-adjustment procedure.</p></td>
</tr>
<tr class="row-odd"><td><p>hist_max</p></td>
<td><p>float</p></td>
<td><p>2.0</p></td>
<td><p>Right boundary of the histograms, in units of <span class="math notranslate nohighlight">\(\chi_\mathrm{min}\)</span>
(left boundary is always set to <span class="math notranslate nohighlight">\(\chi_\mathrm{min}\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p>hist_n_bins</p></td>
<td><p>int</p></td>
<td><p>100</p></td>
<td><p>Number of bins for the histograms.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.clear" title="Link to this definition"></a></dt>
<dd><p>Signature : () -&gt; None</p>
<p>Discard all accumulated particular solutions, histograms and final solutions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.observable_kind">
<span class="sig-name descname"><span class="pre">observable_kind</span></span><a class="headerlink" href="#som.Som.observable_kind" title="Link to this definition"></a></dt>
<dd><p>Kind of the physical observable selected upon construction, one of <code class="docutils literal notranslate"><span class="pre">FermionGf</span></code>, <code class="docutils literal notranslate"><span class="pre">FermionGfSymm</span></code>, <code class="docutils literal notranslate"><span class="pre">BosonCorr</span></code>, <code class="docutils literal notranslate"><span class="pre">BosonAutoCorr</span></code>, <code class="docutils literal notranslate"><span class="pre">ZeroTemp</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#som.Som.dim" title="Link to this definition"></a></dt>
<dd><p>Number <span class="math notranslate nohighlight">\(M\)</span> of diagonal matrix elements in the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.particular_solutions">
<span class="sig-name descname"><span class="pre">particular_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.particular_solutions" title="Link to this definition"></a></dt>
<dd><p>Signature : (int i) -&gt; list[std::pair&lt;configuration, double&gt;]</p>
<p><a class="reference internal" href="../guide/basic.html#particular-solutions"><span class="std std-ref">Particular solutions</span></a> and their respective values of the
objective function <span class="math notranslate nohighlight">\(\chi^2\)</span> for the i-th diagonal element of the observable accumulated on this MPI rank.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Index of the diagonal matrix element of the observable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#tuple" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> [<a class="reference internal" href="#som.Configuration" title="som.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Configuration</span></code></a>, <a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>)]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.objf_min">
<span class="sig-name descname"><span class="pre">objf_min</span></span><a class="headerlink" href="#som.Som.objf_min" title="Link to this definition"></a></dt>
<dd><p>Minimum of the objective function <span class="math notranslate nohighlight">\(\chi^2\)</span> over all accumulated particular solutions
(one value per diagonal matrix element of the observable).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.solution">
<span class="sig-name descname"><span class="pre">solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.solution" title="Link to this definition"></a></dt>
<dd><p>Signature : (int i) -&gt; Configuration</p>
<p><a class="reference internal" href="../guide/basic.html#final-solution"><span class="std std-ref">Final solution</span></a> for the i-th diagonal element of the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Index of the diagonal matrix element of the observable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#som.Configuration" title="som.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Configuration</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.solutions">
<span class="sig-name descname"><span class="pre">solutions</span></span><a class="headerlink" href="#som.Som.solutions" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="../guide/basic.html#final-solution"><span class="std std-ref">Final solutions</span></a>, one per diagonal element of the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference internal" href="#som.Configuration" title="som.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Configuration</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.objf">
<span class="sig-name descname"><span class="pre">objf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.objf" title="Link to this definition"></a></dt>
<dd><p>Signature : (int i) -&gt; float</p>
<p>Value of the objective function <span class="math notranslate nohighlight">\(\chi^2\)</span> of the <a class="reference internal" href="../guide/basic.html#final-solution"><span class="std std-ref">final solution</span></a>
for the i-th diagonal element of the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Index of the diagonal matrix element of the observable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.objf_list">
<span class="sig-name descname"><span class="pre">objf_list</span></span><a class="headerlink" href="#som.Som.objf_list" title="Link to this definition"></a></dt>
<dd><p>Values of the objective function <span class="math notranslate nohighlight">\(\chi^2\)</span> of the <a class="reference internal" href="../guide/basic.html#final-solution"><span class="std std-ref">final solutions</span></a>,
one value per diagonal element of the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Som.histogram">
<span class="sig-name descname"><span class="pre">histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Som.histogram" title="Link to this definition"></a></dt>
<dd><p>Signature : (int i) -&gt; std::optional&lt;histogram&gt;</p>
<p>Accumulated <span class="math notranslate nohighlight">\(\chi\)</span> histogram for the i-th diagonal element of the observable.
Returns <a class="reference external" href="https://docs.python.org/3.10/library/constants.html#None" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if histograms have not been accumulated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Index of the diagonal matrix element of the observable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.stat.histograms.Histogram.html#triqs.stat.histograms.Histogram" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.stat.histograms.Histogram</span></code></a> or <a class="reference external" href="https://docs.python.org/3.10/library/constants.html#None" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Som.histograms">
<span class="sig-name descname"><span class="pre">histograms</span></span><a class="headerlink" href="#som.Som.histograms" title="Link to this definition"></a></dt>
<dd><p>Accumulated <span class="math notranslate nohighlight">\(\chi\)</span> histograms, one per diagonal element of the observable.
<a class="reference external" href="https://docs.python.org/3.10/library/constants.html#None" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if histograms have not been accumulated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.stat.histograms.Histogram.html#triqs.stat.histograms.Histogram" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.stat.histograms.Histogram</span></code></a>] or <a class="reference external" href="https://docs.python.org/3.10/library/constants.html#None" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="free-functions">
<h2>Free functions<a class="headerlink" href="#free-functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="som.fill_refreq">
<span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">fill_refreq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#som.fill_refreq" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs::gfs::gf_view&lt;refreq&gt; g_w, SomCore cont, bool with_binning =  true) -&gt; None
Fill a Green’s function object with the real-frequency version of the continued observable from a computed SOM solution.</p>
<p><strong>Parameters:</strong></p>
<dl class="field-list simple">
<dt class="field-odd">G_w<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.gf.Gf</span></code></a> defined on <a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.meshes.MeshReFreq.html#triqs.gf.meshes.MeshReFreq" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.meshes.MeshReFreq</span></code></a>, target Green’s function object.</p>
</dd>
<dt class="field-even">Cont<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#som.Som" title="som.Som"><code class="xref py py-class docutils literal notranslate"><span class="pre">Som</span></code></a>, Analytic continuation object.</p>
</dd>
<dt class="field-odd">With_binning<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#bool" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, Use <a class="reference internal" href="../guide/recovery.html#binning"><span class="std std-ref">binning</span></a> while projecting onto the real-frequency mesh.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="som.compute_tail">
<span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">compute_tail</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#som.compute_tail" title="Link to this definition"></a></dt>
<dd><p>Signature : (int max_order, SomCore cont) -&gt; nda::array&lt;dcomplex, 3&gt;
Extract <a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/manual/triqs/gfs/c%2B%2B/tail.html#gf-tail" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><span class="xref std std-ref">high-frequency expansion coefficients</span></a> from a computed SOM solution.</p>
<p><strong>Parameters:</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Max_order<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, Maximum tail expansion order.</p>
</dd>
<dt class="field-even">Cont<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#som.Som" title="som.Som"><code class="xref py py-class docutils literal notranslate"><span class="pre">Som</span></code></a>, Analytic continuation object.</p>
</dd>
</dl>
<p><strong>Returns:</strong> 3D complex NumPy array of shape <code class="docutils literal notranslate"><span class="pre">(max_order+1,</span> <span class="pre">cont.dim,</span> <span class="pre">cont.dim)</span></code> with the high-frequency expansion coefficients.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="som.reconstruct">
<span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#som.reconstruct" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs::gfs::gf_view&lt;imtime&gt; g, SomCore cont) -&gt; None
Reconstruct a physical observable in the imaginary-time representation from a computed SOM solution.</p>
<p><strong>Parameters:</strong></p>
<dl class="field-list simple">
<dt class="field-odd">G<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.gf.Gf</span></code></a> defined on <a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.meshes.MeshImTime.html#triqs.gf.meshes.MeshImTime" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.meshes.MeshImTime</span></code></a>, target Green’s function object.</p>
</dd>
<dt class="field-even">Cont<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#som.Som" title="som.Som"><code class="xref py py-class docutils literal notranslate"><span class="pre">Som</span></code></a>, Analytic continuation object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="som.estimate_boson_corr_spectrum_norms">
<span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">estimate_boson_corr_spectrum_norms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><span class="pre">Gf</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.List" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/som/som.html#estimate_boson_corr_spectrum_norms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#som.estimate_boson_corr_spectrum_norms" title="Link to this definition"></a></dt>
<dd><p>Given a correlator <span class="math notranslate nohighlight">\(\chi\)</span> of bosonic or boson-like
(fermion-number-conserving) operators, estimates the corresponding spectrum
normalization constants <span class="math notranslate nohighlight">\(\mathcal{N}\)</span>.</p>
<p>Depending on the mesh <span class="math notranslate nohighlight">\(\chi\)</span> is defined on, one of the following
expressions is used.</p>
<ul class="simple">
<li><p>Imaginary frequencies: <span class="math notranslate nohighlight">\(\mathcal{N} = \pi\chi(i\Omega=0)\)</span>.</p></li>
<li><p>Imaginary time: <span class="math notranslate nohighlight">\(\mathcal{N} = \pi\int_0^\beta d\tau \chi(\tau)\)</span>.</p></li>
<li><p>Legendre polynomial basis coefficients: <span class="math notranslate nohighlight">\(\mathcal{N} =
\pi\chi(\ell=0)\)</span>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chi</strong> (<a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.gf.gf.Gf.html#triqs.gf.gf.Gf" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.gf.gf.Gf</span></code></a>) – The correlator <span class="math notranslate nohighlight">\(\chi\)</span>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of estimated spectrum normalization constants,
one constant per diagonal matrix element of <span class="math notranslate nohighlight">\(\chi\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#list" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="som.count_good_solutions">
<span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">count_good_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.stat.histograms.Histogram.html#triqs.stat.histograms.Histogram" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><span class="pre">Histogram</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">good_chi_rel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">good_chi_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/som/som.html#count_good_solutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#som.count_good_solutions" title="Link to this definition"></a></dt>
<dd><p>Given a histogram of values <span class="math notranslate nohighlight">\(\chi\)</span> for the objective function
<span class="math notranslate nohighlight">\(\chi^2\)</span>, counts the number of such solutions that
<span class="math notranslate nohighlight">\(\chi \leq\)</span> <code class="docutils literal notranslate"><span class="pre">good_chi_abs</span></code> and
<span class="math notranslate nohighlight">\(\chi/\chi_\mathrm{min} \leq\)</span> <code class="docutils literal notranslate"><span class="pre">good_chi_rel</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> (<a class="reference external" href="https://triqs.github.io/triqs/3.3.x/documentation/python_api/triqs.stat.histograms.Histogram.html#triqs.stat.histograms.Histogram" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">triqs.stat.histograms.Histogram</span></code></a>) – Histogram to analyze.</p></li>
<li><p><strong>good_chi_rel</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, optional) – <span class="math notranslate nohighlight">\(\chi/\chi_\mathrm{min}\)</span> threshold for good
solutions.</p></li>
<li><p><strong>good_chi_abs</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, optional) – <span class="math notranslate nohighlight">\(\chi\)</span> threshold for good solutions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="auxiliary-types">
<h2>Auxiliary types<a class="headerlink" href="#auxiliary-types" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="som.Rectangle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">Rectangle</span></span><a class="headerlink" href="#som.Rectangle" title="Link to this definition"></a></dt>
<dd><p>The rectangular function of energy, basis element of a spectral function.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="som.Rectangle.center">
<span class="sig-name descname"><span class="pre">center</span></span><a class="headerlink" href="#som.Rectangle.center" title="Link to this definition"></a></dt>
<dd><p>float: Center of the rectangle <span class="math notranslate nohighlight">\(c\)</span>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Rectangle.width">
<span class="sig-name descname"><span class="pre">width</span></span><a class="headerlink" href="#som.Rectangle.width" title="Link to this definition"></a></dt>
<dd><p>float: Width of the rectangle <span class="math notranslate nohighlight">\(w\)</span>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Rectangle.height">
<span class="sig-name descname"><span class="pre">height</span></span><a class="headerlink" href="#som.Rectangle.height" title="Link to this definition"></a></dt>
<dd><p>float: Height of the rectangle <span class="math notranslate nohighlight">\(h\)</span>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="som.Rectangle.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><a class="headerlink" href="#som.Rectangle.norm" title="Link to this definition"></a></dt>
<dd><p>float: Norm (area) of the rectangle <span class="math notranslate nohighlight">\(hw\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Rectangle.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Rectangle.__call__" title="Link to this definition"></a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="som.Configuration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">som.</span></span><span class="sig-name descname"><span class="pre">Configuration</span></span><a class="headerlink" href="#som.Configuration" title="Link to this definition"></a></dt>
<dd><p>A SOM configuration (spectral function) as a list of <a class="reference internal" href="#som.Rectangle" title="som.Rectangle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rectangle</span></code></a>’s, and a function of energy, which is the sum of the rectangles.</p>
<dl class="py method">
<dt class="sig sig-object py" id="som.Configuration.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#som.Configuration.__len__" title="Link to this definition"></a></dt>
<dd><p>Return len(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Configuration.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Configuration.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Return self[key].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Configuration.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#som.Configuration.__iter__" title="Link to this definition"></a></dt>
<dd><p>Implement iter(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="som.Configuration.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" rel="noopener noreferrer" target="_blank" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#som.Configuration.__call__" title="Link to this definition"></a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Python API reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spectral_stats.html" class="btn btn-neutral float-right" title="som.spectral_stats: Statistical analysis of noisy spectral functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2025, Igor Krivenko.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>